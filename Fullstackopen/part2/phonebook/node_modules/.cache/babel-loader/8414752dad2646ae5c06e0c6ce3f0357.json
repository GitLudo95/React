{"ast":null,"code":"import _objectSpread from\"/Users/ludo/git/React/Fullstackopen/part2/phonebook/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _toConsumableArray from\"/Users/ludo/git/React/Fullstackopen/part2/phonebook/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"/Users/ludo/git/React/Fullstackopen/part2/phonebook/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import'./index.css';import React,{useState,useEffect}from'react';import http from'./httplib';import IconLabelButtons from'./iconbuttonlib';import AddIcon from'@material-ui/icons/Add';import DeleteIcon from'@material-ui/icons/Delete';import Input from'@material-ui/core/Input';import Alert from'@material-ui/lab/Alert';var IconButton=function IconButton(props){return/*#__PURE__*/React.createElement(\"span\",null,IconLabelButtons(props.variant,props.type,props.color,props.text,props.icon,props.handleClick));};var StatusBar=function StatusBar(props){if(props.status){return/*#__PURE__*/React.createElement(Alert,{variant:props.variant,severity:props.status},props.text);}else{return null;}};var Form=function Form(props){var _useState=useState({error:false,message:''}),_useState2=_slicedToArray(_useState,2),nameError=_useState2[0],setNameError=_useState2[1];var _useState3=useState({error:false,message:''}),_useState4=_slicedToArray(_useState3,2),numberError=_useState4[0],setNumberError=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),newName=_useState6[0],setNewName=_useState6[1];var _useState7=useState(''),_useState8=_slicedToArray(_useState7,2),newNumber=_useState8[0],setNewNumber=_useState8[1];var updateNameInput=function updateNameInput(event){setNameError({error:false,message:''});setNewName(event.target.value);};var updateNumberInput=function updateNumberInput(event){setNumberError({error:false,message:''});setNewNumber(event.target.value);};function create_UUID(){var dt=new Date().getTime();var uuid='xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g,function(c){var r=(dt+Math.random()*16)%16|0;dt=Math.floor(dt/16);return(c==='x'?r:r&0x3|0x8).toString(16);});return uuid;}var checkIfNameExists=function checkIfNameExists(){return props.persons.filter(function(person){return person.name===newName;});};var validateForm=function validateForm(){var nameIsEmpty=!newName;var nameMessage=nameIsEmpty?'Field is required':'';var isNameValid=!nameIsEmpty;setNameError({error:!isNameValid,message:nameMessage});var numberIsEmpty=!newNumber;var numberMessage=numberIsEmpty?'Field is required':'';var isNumberValid=!numberIsEmpty;setNumberError({error:!isNumberValid,message:numberMessage});return isNameValid&&isNumberValid;};var updateArray=function updateArray(oldArr,updatedEntry){var newArr=_toConsumableArray(oldArr);var i=0;var length=newArr.length;for(i;i<length;i++){if(newArr[i].id===updatedEntry.id){newArr[i]=updatedEntry;break;}}return newArr;};var handleSubmit=function handleSubmit(event){var existingPerson=checkIfNameExists();event.preventDefault();if(validateForm()){if(existingPerson.length>0&&window.confirm(\"\".concat(newName,\" is already added to phonebook, replace the old number with a new one?\"))){var updatedPerson=_objectSpread({},existingPerson[0]);updatedPerson.number=newNumber;http.update(updatedPerson.id,updatedPerson).then(function(returnedPerson){console.log('promise fulfilled',returnedPerson);props.setStatus({variant:\"filled\",status:\"success\",text:\"Succesfully updated \".concat(newName)});setTimeout(function(){props.setStatus({});},5000);var newPersonList=updateArray(props.persons,returnedPerson);props.setPersons(newPersonList);props.setSearchResults(props.getSearchResults(newPersonList,props.searchTerm));setNewName('');setNewNumber('');}).catch(function(error){props.setStatus({variant:\"filled\",status:\"error\",text:\"Oops something went wrong\"});setTimeout(function(){props.setStatus({});},5000);});}else if(existingPerson.length===0){http.create({name:newName,number:newNumber,id:create_UUID()}).then(function(returnedPerson){console.log('promise fulfilled',returnedPerson);props.setStatus({variant:\"filled\",status:\"success\",text:\"Succesfully added \".concat(newName)});setTimeout(function(){props.setStatus({});},5000);var newPersonList=_toConsumableArray(props.persons).concat(returnedPerson);props.setPersons(newPersonList);props.setSearchResults(props.getSearchResults(newPersonList,props.searchTerm));setNewName('');setNewNumber('');}).catch(function(error){props.setStatus({variant:\"filled\",status:\"error\",text:\"Oops something went wrong\"});setTimeout(function(){props.setStatus({});},5000);});}}};return/*#__PURE__*/React.createElement(\"form\",null,/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(Input,{error:nameError.error,name:\"Name\",type:\"text\",value:newName,placeholder:\"name\",onChange:updateNameInput}),/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"span\",{className:\"error\"},nameError.message))),/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(Input,{error:numberError.error,name:\"Number\",type:\"text\",value:newNumber,placeholder:\"number\",onChange:updateNumberInput}),/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"span\",{className:\"error\"},numberError.message))),/*#__PURE__*/React.createElement(\"div\",null,IconLabelButtons(\"contained\",\"submit\",\"primary\",\"add\",/*#__PURE__*/React.createElement(AddIcon,null),handleSubmit)));};var Search=function Search(props){var updateSearchInput=function updateSearchInput(event){props.setSearchTerm(event.target.value);var results=props.getSearchResults(props.persons,event.target.value);props.setSearchResults(results);};return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(Input,{name:\"Search\",value:props.searchTerm,type:\"text\",placeholder:\"enter a searchterm\",onInput:updateSearchInput}));};var Numbers=function Numbers(props){var removeFromArray=function removeFromArray(oldArr,id){var newArr=_toConsumableArray(oldArr);var i=0;var length=newArr.length;for(i;i<length;i++){if(newArr[i].id===id){newArr.splice(i);break;}}return newArr;};var handleDeleteClick=function handleDeleteClick(name,id){if(window.confirm(\"Do you really want to delete \".concat(name))){http.deleteEntry(id).then(function(response){console.log('promise fulfilled',response);props.setStatus({variant:\"filled\",status:\"success\",text:\"Succesfully deleted \".concat(name)});setTimeout(function(){props.setStatus({});},5000);var newPersonList=removeFromArray(props.persons,id);props.setPersons(newPersonList);props.setSearchResults(props.getSearchResults(newPersonList,props.searchTerm));}).catch(function(error){props.setStatus({variant:\"filled\",status:\"error\",text:\"Oops something went wrong\"});setTimeout(function(){props.setStatus({});},5000);});}};return/*#__PURE__*/React.createElement(\"div\",null,props.searchResults.map(function(person){return/*#__PURE__*/React.createElement(\"li\",{key:person.id},person.name,\" \",person.number,\" \",/*#__PURE__*/React.createElement(IconButton,{variant:\"contained\",type:\"button\",color:\"primary\",text:\"delete\",icon:/*#__PURE__*/React.createElement(DeleteIcon,null),handleClick:function handleClick(){return handleDeleteClick(person.name,person.id);}}));}));};var App=function App(){var _useState9=useState([]),_useState10=_slicedToArray(_useState9,2),persons=_useState10[0],setPersons=_useState10[1];var _useState11=useState({}),_useState12=_slicedToArray(_useState11,2),status=_useState12[0],setStatus=_useState12[1];useEffect(function(){http.getAll().then(function(initialPersons){console.log('promise fulfilled',initialPersons);setStatus({variant:\"filled\",status:\"success\",text:\"Succesfully retrieved phonebook\"});setTimeout(function(){setStatus({});},5000);setPersons(initialPersons);setSearchResults(initialPersons);}).catch(function(error){setStatus({variant:\"filled\",status:\"error\",text:\"Oops something went wrong\"});setTimeout(function(){setStatus({});},5000);});},[]);var _useState13=useState(_toConsumableArray(persons)),_useState14=_slicedToArray(_useState13,2),searchResults=_useState14[0],setSearchResults=_useState14[1];var getSearchResults=function getSearchResults(personList,criteria){return personList.filter(function(person){return person.name.toLowerCase().startsWith(criteria.toLowerCase());});};var _useState15=useState(''),_useState16=_slicedToArray(_useState15,2),searchTerm=_useState16[0],setSearchTerm=_useState16[1];return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"h2\",null,\"Phonebook\"),/*#__PURE__*/React.createElement(Search,{persons:persons,setPersons:setPersons,searchTerm:searchTerm,setSearchTerm:setSearchTerm,searchResults:searchResults,setSearchResults:setSearchResults,getSearchResults:getSearchResults}),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(Form,{persons:persons,setPersons:setPersons,searchTerm:searchTerm,searchResults:searchResults,setSearchResults:setSearchResults,getSearchResults:getSearchResults,setStatus:setStatus}),/*#__PURE__*/React.createElement(\"h2\",null,\"Numbers\"),/*#__PURE__*/React.createElement(Numbers,{searchResults:searchResults,persons:persons,setPersons:setPersons,searchTerm:searchTerm,setSearchResults:setSearchResults,getSearchResults:getSearchResults,setStatus:setStatus}),/*#__PURE__*/React.createElement(StatusBar,{variant:status.variant,status:status.status,text:status.text}));};export default App;","map":{"version":3,"sources":["/Users/ludo/git/React/Fullstackopen/part2/phonebook/src/app.js"],"names":["React","useState","useEffect","http","IconLabelButtons","AddIcon","DeleteIcon","Input","Alert","IconButton","props","variant","type","color","text","icon","handleClick","StatusBar","status","Form","error","message","nameError","setNameError","numberError","setNumberError","newName","setNewName","newNumber","setNewNumber","updateNameInput","event","target","value","updateNumberInput","create_UUID","dt","Date","getTime","uuid","replace","c","r","Math","random","floor","toString","checkIfNameExists","persons","filter","person","name","validateForm","nameIsEmpty","nameMessage","isNameValid","numberIsEmpty","numberMessage","isNumberValid","updateArray","oldArr","updatedEntry","newArr","i","length","id","handleSubmit","existingPerson","preventDefault","window","confirm","updatedPerson","number","update","then","returnedPerson","console","log","setStatus","setTimeout","newPersonList","setPersons","setSearchResults","getSearchResults","searchTerm","catch","create","concat","Search","updateSearchInput","setSearchTerm","results","Numbers","removeFromArray","splice","handleDeleteClick","deleteEntry","response","searchResults","map","App","getAll","initialPersons","personList","criteria","toLowerCase","startsWith"],"mappings":"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","sourcesContent":["import './index.css';\n\nimport React, { useState, useEffect } from 'react';\nimport http from './httplib';\n\nimport IconLabelButtons from './iconbuttonlib';\nimport AddIcon from '@material-ui/icons/Add';\nimport DeleteIcon from '@material-ui/icons/Delete';\nimport Input from '@material-ui/core/Input';\nimport Alert from '@material-ui/lab/Alert';\n\nconst IconButton = (props) => {\n  return(\n    <span>\n      {IconLabelButtons(props.variant, props.type, props.color, props.text, props.icon, props.handleClick)}\n    </span>\n  )\n}\n\nconst StatusBar = (props) => {\n  if(props.status) {\n    return(\n      <Alert variant={props.variant} severity={props.status}>\n        {props.text}\n      </Alert>\n    )\n  } else {\n    return null;\n  }\n}\n\nconst Form = (props) => {\n  const [ nameError, setNameError ] = useState({error : false, message : ''});\n  const [ numberError, setNumberError ] = useState({error : false, message : ''});\n\n  const [ newName, setNewName ] = useState('');\n  const [ newNumber, setNewNumber ] = useState('');\n\n  const updateNameInput = (event) => {\n    setNameError({error : false, message : ''});\n    setNewName(event.target.value);\n  }\n  const updateNumberInput = (event) => {\n    setNumberError({error : false, message : ''});\n    setNewNumber(event.target.value);\n  }\n\n  function create_UUID(){\n    let dt = new Date().getTime();\n    let uuid = 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {\n        let r = (dt + Math.random()*16)%16 | 0;\n        dt = Math.floor(dt/16);\n        return (c==='x' ? r :(r&0x3|0x8)).toString(16);\n    });\n    return uuid;\n  }\n\n  const checkIfNameExists = () => {\n    return props.persons.filter((person) => {\n      return person.name === newName\n    });\n  }\n\n  const validateForm = () => {\n    let nameIsEmpty = !newName;\n    let nameMessage = nameIsEmpty ? 'Field is required' : '';\n    let isNameValid = !nameIsEmpty;\n    setNameError({error : !isNameValid, message : nameMessage});\n\n    let numberIsEmpty = !newNumber;\n    let numberMessage = numberIsEmpty ? 'Field is required' : '';\n    let isNumberValid = !(numberIsEmpty);\n    setNumberError({error : !isNumberValid, message : numberMessage});\n    return (isNameValid && isNumberValid);\n  }\n\n  const updateArray = (oldArr, updatedEntry) => {\n    let newArr = [...oldArr];\n    let i = 0;\n    let length = newArr.length;\n    for(i; i < length; i++) {\n      if(newArr[i].id === updatedEntry.id) {\n        newArr[i] = updatedEntry;\n        break;\n      }\n    }\n    return newArr;\n  }\n\n  const handleSubmit = (event) => {\n    const existingPerson = checkIfNameExists();\n    event.preventDefault();\n    if(validateForm()) {\n        if(existingPerson.length > 0 && window.confirm(`${newName} is already added to phonebook, replace the old number with a new one?`)) {\n          const updatedPerson = {...existingPerson[0]};\n          updatedPerson.number = newNumber;\n          http\n          .update(updatedPerson.id, updatedPerson)\n          .then(returnedPerson => {\n            console.log('promise fulfilled', returnedPerson);\n            props.setStatus({variant : \"filled\", status : \"success\", text : `Succesfully updated ${newName}`});\n            setTimeout(() => {         \n              props.setStatus({});  \n            }, 5000)\n            let newPersonList = updateArray(props.persons, returnedPerson);\n            props.setPersons(newPersonList);\n            props.setSearchResults(props.getSearchResults(newPersonList, props.searchTerm));\n            setNewName('');\n            setNewNumber('');\n          })\n          .catch(error => {\n            props.setStatus({variant : \"filled\", status : \"error\", text : `Oops something went wrong`});\n            setTimeout(() => {         \n              props.setStatus({});  \n            }, 5000)\n          })\n        } else if(existingPerson.length === 0) {\n          http\n          .create({ name : newName, number : newNumber, id : create_UUID() })\n          .then(returnedPerson => {\n            console.log('promise fulfilled', returnedPerson);\n            props.setStatus({variant : \"filled\", status : \"success\", text : `Succesfully added ${newName}`});\n            setTimeout(() => {         \n              props.setStatus({});  \n            }, 5000)\n            let newPersonList = [...props.persons].concat(returnedPerson);\n            props.setPersons(newPersonList);\n            props.setSearchResults(props.getSearchResults(newPersonList, props.searchTerm));\n            setNewName('');\n            setNewNumber('');\n          })\n          .catch(error => {\n            props.setStatus({variant : \"filled\", status : \"error\", text : `Oops something went wrong`});\n            setTimeout(() => {         \n              props.setStatus({});  \n            }, 5000)\n          })\n      }\n    }\n  }\n\n  return(\n    <form>\n      <div>\n       <Input error={nameError.error} name='Name' type=\"text\" value={newName} placeholder='name' onChange={updateNameInput}/>\n        <div>\n          <span className='error'>{nameError.message}</span>\n        </div>\n      </div>\n      <div>\n        <Input error={numberError.error} name='Number' type=\"text\" value={newNumber} placeholder='number' onChange={updateNumberInput}/>\n        <div>\n          <span className='error'>{numberError.message}</span>\n        </div>\n      </div>\n      <div>\n      {IconLabelButtons(\"contained\", \"submit\", \"primary\", \"add\", <AddIcon/>, handleSubmit)}\n      </div>\n    </form>\n  )\n}\n\nconst Search = (props) => {\n\n  const updateSearchInput = (event) => {\n    props.setSearchTerm(event.target.value);\n    let results = props.getSearchResults(props.persons, event.target.value);\n    props.setSearchResults(results);\n  }\n  \n  return(\n    <div>\n      <Input name='Search' value={props.searchTerm} type=\"text\" placeholder='enter a searchterm' onInput={updateSearchInput}/>\n    </div>\n  )\n}\n\nconst Numbers = (props) => {\n  \n  const removeFromArray = (oldArr, id) => {\n    let newArr = [...oldArr];\n    let i = 0;\n    let length = newArr.length;\n    for(i; i < length; i++) {\n      if(newArr[i].id === id) {\n        newArr.splice(i);\n        break;\n      }\n    }\n    return newArr;\n  }\n  \n  const handleDeleteClick = (name, id) => {\n    if(window.confirm(`Do you really want to delete ${name}`)) {\n      http\n      .deleteEntry(id)\n      .then(response => {\n        console.log('promise fulfilled', response);\n        props.setStatus({variant : \"filled\", status : \"success\", text : `Succesfully deleted ${name}`});\n        setTimeout(() => {         \n          props.setStatus({});  \n        }, 5000)\n        let newPersonList = removeFromArray(props.persons, id);\n        props.setPersons(newPersonList);\n        props.setSearchResults(props.getSearchResults(newPersonList, props.searchTerm));\n      })\n      .catch(error => {\n        props.setStatus({variant : \"filled\", status : \"error\", text : `Oops something went wrong`});\n        setTimeout(() => {         \n          props.setStatus({});  \n        }, 5000)\n      })\n    }\n  }\n  \n  return(\n    <div>\n      {props.searchResults.map((person) => {\n        return (\n          <li \n            key={person.id}>{person.name} {person.number} <IconButton variant=\"contained\" type=\"button\" color=\"primary\" text=\"delete\" icon={<DeleteIcon/>} handleClick={() => handleDeleteClick(person.name, person.id)} />\n          </li>)\n      })}\n    </div>\n  )\n}\n\nconst App = () => {\n\n  const [ persons, setPersons ] = useState([]);\n\n  const [ status, setStatus ] = useState({});\n\n  useEffect(() => {\n    http\n      .getAll()\n      .then(initialPersons => {\n        console.log('promise fulfilled', initialPersons);\n        setStatus({variant : \"filled\", status : \"success\", text : \"Succesfully retrieved phonebook\"});\n        setTimeout(() => {         \n          setStatus({});  \n        }, 5000)\n        setPersons(initialPersons);\n        setSearchResults(initialPersons);\n      })\n      .catch(error => {\n        setStatus({variant : \"filled\", status : \"error\", text : `Oops something went wrong`});\n        setTimeout(() => {         \n          setStatus({});  \n        }, 5000)\n      })\n  }, [])\n\n  const [ searchResults, setSearchResults ] = useState([...persons]);\n  const getSearchResults = (personList, criteria) => personList.filter((person) => person.name.toLowerCase().startsWith(criteria.toLowerCase()));\n\n  const [searchTerm, setSearchTerm] = useState('');\n\n  return (\n    <div>\n      <h2>Phonebook</h2>\n      <Search persons={persons} setPersons={setPersons} searchTerm={searchTerm} setSearchTerm={setSearchTerm} searchResults={searchResults} setSearchResults={setSearchResults} getSearchResults={getSearchResults} />\n      <br></br>\n      <Form persons={persons} setPersons={setPersons} searchTerm={searchTerm} searchResults={searchResults} setSearchResults={setSearchResults} getSearchResults={getSearchResults} setStatus={setStatus} />\n      <h2>Numbers</h2>\n      <Numbers searchResults={searchResults} persons={persons} setPersons={setPersons} searchTerm={searchTerm} setSearchResults={setSearchResults} getSearchResults={getSearchResults} setStatus={setStatus} />\n      <StatusBar variant={status.variant} status={status.status} text={status.text} />\n    </div>\n  )\n}\n\nexport default App"]},"metadata":{},"sourceType":"module"}